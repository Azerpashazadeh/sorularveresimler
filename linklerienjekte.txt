<!DOCTYPE html>
<html lang="tr">
<head>
    <meta charset="UTF-8">
    <title>JSON Sadece BaÄŸlantÄ± EnjektÃ¶rÃ¼</title>
    <style>
        body { font-family: 'Segoe UI', sans-serif; padding: 20px; background-color: #f0f2f5; color: #333; }
        .container { max-width: 1200px; margin: auto; background: white; padding: 25px; border-radius: 12px; box-shadow: 0 4px 15px rgba(0,0,0,0.1); }
        h2 { color: #2c3e50; text-align: center; border-bottom: 2px solid #e74c3c; padding-bottom: 10px; }
        .grid-layout { display: grid; grid-template-columns: 1fr 1fr; gap: 20px; margin-top: 20px; }
        .box { display: flex; flex-direction: column; }
        label { font-weight: bold; margin-bottom: 8px; color: #444; display: flex; justify-content: space-between; }
        textarea { height: 250px; padding: 10px; border: 1px solid #cbd5e0; border-radius: 8px; font-family: 'Consolas', monospace; font-size: 13px; background-color: #fafafa; }
        .controls { text-align: center; margin: 30px 0; }
        .main-btn { background: #e74c3c; color: white; border: none; padding: 15px 40px; border-radius: 8px; cursor: pointer; font-size: 18px; font-weight: bold; }
        .copy-btn { background: #2ecc71; color: white; border: none; padding: 4px 10px; border-radius: 4px; cursor: pointer; }
        #status { margin-top: 15px; padding: 10px; border-radius: 6px; text-align: center; font-weight: bold; display: none; }
        .success { background: #d4edda; color: #155724; display: block !important; }
        .error { background: #f8d7da; color: #721c24; display: block !important; }
    </style>
</head>
<body>

<div class="container">
    <h2>ðŸ”— Sadece BaÄŸlantÄ±larÄ± Enjekte Et (Metinleri Korur)</h2>
    
    <div class="box" style="margin-bottom: 20px;">
        <label>1. BAZ ALINACAK (KAYNAK) JSON:</label>
        <textarea id="baseJson" placeholder="BaÄŸlantÄ±larÄ±n alÄ±nacaÄŸÄ± ana dosyayÄ± buraya yapÄ±ÅŸtÄ±r..."></textarea>
    </div>

    <div class="grid-layout">
        <div class="box">
            <label>HEDEF DOSYA 1: <button class="copy-btn" onclick="copyToClipboard('target1')">Kopyala</button></label>
            <textarea id="target1" placeholder="Dili korunacak 1. dosyayÄ± yapÄ±ÅŸtÄ±r..."></textarea>
        </div>
        <div class="box">
            <label>HEDEF DOSYA 2: <button class="copy-btn" onclick="copyToClipboard('target2')">Kopyala</button></label>
            <textarea id="target2" placeholder="Dili korunacak 2. dosyayÄ± yapÄ±ÅŸtÄ±r..."></textarea>
        </div>
        <div class="box">
            <label>HEDEF DOSYA 3: <button class="copy-btn" onclick="copyToClipboard('target3')">Kopyala</button></label>
            <textarea id="target3" placeholder="Dili korunacak 3. dosyayÄ± yapÄ±ÅŸtÄ±r..."></textarea>
        </div>
        <div class="box" style="justify-content: center; border: 1px dashed #ccc; border-radius: 8px;">
            <div id="status"></div>
            <p style="font-size: 12px; color: #666; padding: 10px;">Not: Bu sÃ¼rÃ¼m sadece <b>resim, video ve feedback ikonlarÄ±nÄ±</b> gÃ¼nceller. Soru ve cevap metinlerine asla dokunmaz.</p>
        </div>
    </div>

    <div class="controls">
        <button class="main-btn" onclick="processSync()">SADECE LÄ°NKLERÄ° GÃœNCELLE</button>
    </div>
</div>

<script>
    function copyToClipboard(id) {
        const textElement = document.getElementById(id);
        textElement.select();
        document.execCommand("copy");
        alert("BaÅŸarÄ±yla kopyalandÄ±!");
    }

    function processSync() {
        const statusDiv = document.getElementById('status');
        const ids = ['target1', 'target2', 'target3'];
        
        try {
            const baseText = document.getElementById('baseJson').value;
            if(!baseText) throw new Error("Referans JSON boÅŸ!");
            const baseJson = JSON.parse(baseText);
            const baseMap = new Map();
            baseJson.sorular.forEach(s => baseMap.set(s.numara, s));

            ids.forEach(id => {
                const area = document.getElementById(id);
                if(!area.value.trim()) return;

                let currentJson = JSON.parse(area.value);
                
                currentJson.sorular.forEach(targetSoru => {
                    const bSoru = baseMap.get(targetSoru.numara);
                    if (bSoru) {
                        // 1. Ana GÃ¶rsel ve Video
                        if (bSoru.resim !== undefined) targetSoru.resim = bSoru.resim;
                        if (bSoru.video !== undefined) targetSoru.video = bSoru.video;

                        // 2. Feedback Ä°konlarÄ± (Ä°Ã§indeki metne dokunmadan sadece linkleri alÄ±r)
                        if (bSoru.feedback && targetSoru.feedback) {
                            targetSoru.feedback.dogruCevapResim = bSoru.feedback.dogruCevapResim;
                            targetSoru.feedback.yanlisCevapResim = bSoru.feedback.yanlisCevapResim;
                            targetSoru.feedback.cevaplanmamisResim = bSoru.feedback.cevaplanmamisResim;
                        }

                        // 3. T4 Tipi Resimli SeÃ§enekler (Sadece metin olmayan, link iÃ§eren yapÄ±larÄ± aktarÄ±r)
                        // EÄŸer seÃ§enekler dizisi varsa, sadece link olan kÄ±sÄ±mlarÄ± eÅŸleÅŸtiriyoruz
                        if (Array.isArray(bSoru.cevaplar) && Array.isArray(targetSoru.cevaplar)) {
                            bSoru.cevaplar.forEach((item, index) => {
                                if (typeof item === 'string' && item.startsWith('http')) {
                                    targetSoru.cevaplar[index] = item;
                                }
                            });
                        }
                    }
                });

                area.value = JSON.stringify(currentJson, null, 4);
            });

            statusDiv.className = "success";
            statusDiv.innerText = "Ä°ÅžLEM TAMAM: Sadece baÄŸlantÄ±lar gÃ¼ncellendi!";
        } catch (e) {
            statusDiv.className = "error";
            statusDiv.innerText = "Hata: " + e.message;
        }
    }
</script>
</body>
</html>